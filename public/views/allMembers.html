<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>User Directory</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root {
  --bg: #f0f2f5;
  --card-bg: #ffffff;
  --text: #2c3e50;
  --border: #dcdde1;
  --accent: #3498db;
  --highlight: #2ecc71;
  --font-size-base: 0.85rem;
  --font-size-small: 0.7rem;
  --font-size-xsmall: 0.65rem;
}

[data-theme="dark"] {
  --bg: #1e1e2f;
  --card-bg: #2f3542;
  --text: #ecf0f1;
  --border: #57606f;
  --accent: #74b9ff;
  --highlight: #55efc4;
}

body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: var(--bg);
  color: var(--text);
  font-size: var(--font-size-base);
  transition: background-color 0.3s, color 0.3s;
  line-height: 1.3;
  height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.marquee {
  background: var(--accent);
  color: white;
  padding: 0.4rem;
  font-weight: bold;
  font-size: var(--font-size-small);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
}

.app-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0.8rem;
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  height: calc(100% - 2rem);
}

header {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.8rem;
  text-align: center;
  position: relative;
  flex-shrink: 0;
}

h1 {
  font-size: 1.4rem;
  color: var(--accent);
  margin: 0.5rem 0;
}

#search {
  padding: 0.5rem;
  font-size: var(--font-size-base);
  width: 100%;
  max-width: 350px;
  border: 1px solid var(--border);
  border-radius: 4px;
  background-color: var(--card-bg);
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

#themeToggle {
  background-color: var(--accent);
  color: white;
  border: none;
  padding: 0.4rem 0.8rem;
  border-radius: 4px;
  font-size: var(--font-size-small);
  cursor: pointer;
  margin-top: 0.3rem;
}

.back-home {
  position: absolute;
  top: 0;
  left: 0;
  background-color: #226cf5;
  color: #92f520;
  padding: 0.2rem 0.5rem;
  font-size: var(--font-size-small);
  text-decoration: none;
  border-radius: 4px;
}

.birthday-dashboard {
  border: 1px solid var(--border);
  border-radius: 6px;
  background-color: var(--card-bg);
  padding: 0.8rem;
  margin-bottom: 0.8rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  flex-shrink: 0;
}

.metrics-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 0.8rem;
}

.metric-card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 0.6rem;
  flex: 1;
  min-width: 100%;
  font-size: var(--font-size-small);
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.metric-flex {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 0.5rem;
}

.metric-section {
  flex: 1;
  min-width: 150px;
  background-color: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.4rem;
  font-size: var(--font-size-small);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  overflow: hidden;
}

.metric-section h3 {
  font-size: var(--font-size-small);
  margin: 0 0 0.2rem 0;
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

#birthdayChart {
  width: 100% !important;
  height: 120px !important;
}

.content-wrapper {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.user-container-wrapper {
  flex: 1;
  overflow: auto;
}

main {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 0.8rem;
  padding: 0.2rem;
}

.user-card {
  background-color: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 0.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  transition: transform 0.2s;
  font-size: var(--font-size-small);
  overflow: hidden;
  height: fit-content;
}

.user-card:hover {
  transform: translateY(-2px);
}

.user-card h3 {
  margin: 0 0 0.2rem 0;
  font-size: var(--font-size-base);
  color: var(--accent);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-card p {
  margin: 0.15rem 0;
  font-size: var(--font-size-xsmall);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.upcoming {
  color: var(--highlight);
  font-weight: bold;
}

ul {
  list-style: none;
  padding-left: 0;
  margin: 0.2rem 0;
}

li {
  padding: 0.15rem 0;
  font-size: var(--font-size-xsmall);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .metric-section {
    min-width: 120px;
  }
  
  main {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  }
}

@media (max-width: 480px) {
  :root {
    --font-size-base: 0.8rem;
    --font-size-small: 0.65rem;
    --font-size-xsmall: 0.6rem;
  }
  
  .app-container {
    padding: 0.5rem;
  }
  
  .metric-flex {
    flex-direction: column;
  }
  
  .metric-section {
    min-width: 100%;
  }
  
  main {
    grid-template-columns: 1fr;
  }
  
  #birthdayChart {
    height: 100px !important;
  }
}
</style>
</head>
<body>
<div class="marquee">
üì¢ Announcement: Please update your profile information before the end of the month.
</div>

<div class="app-container">
<header>
<a href="/" class="back-home">‚Üê</a>
<h1>User Directory</h1>
<input type="text" id="search" placeholder="Search by name..." />
<button id="themeToggle">Toggle Theme</button>
</header>
<div class="birthday-dashboard">
<div class="metrics-container">
<div class="metric-card">
  <div class="metric-flex">
    <div class="metric-section">
      <h3>üìä Birthdays by Day</h3>
      <canvas id="birthdayChart"></canvas>
    </div>

    <div class="metric-section">
      <h3>üéÇ Upcoming (7 days)</h3>
      <ul id="upcomingBirthdays"></ul>
    </div>

    <div class="metric-section">
      <h3>üìÖ All Birthdays</h3>
      <ul id="allBirthdays"></ul>
    </div>

    <div class="metric-section">
      <h3>üí¨ Birthday Chats</h3>
      <ul id="birthdayChats"></ul>
    </div>
  </div>
</div>
</div>
</div>

<div class="content-wrapper">
<div class="user-container-wrapper">
<main id="userContainer"></main>
</div>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
const container = document.getElementById("userContainer");
const searchInput = document.getElementById("search");
const themeToggle = document.getElementById("themeToggle");
const upcomingList = document.getElementById("upcomingBirthdays");
const allBirthdaysList = document.getElementById("allBirthdays");
const birthdayChats = document.getElementById("birthdayChats");
let users = [];

// Mock data for demonstration - replace with your actual data loading
function loadUsers() {
  // In a real app, you would fetch this from your API
  users = [
    { id: 1, name: "John Doe", email: "john@example.com", phone: "123-456-7890", gender: "Male", age: 30, status: "Active", dob: "1993-08-15" },
    { id: 2, name: "Jane Smith", email: "jane@example.com", phone: "234-567-8901", gender: "Female", age: 28, status: "Active", dob: "1995-09-20" },
    { id: 3, name: "Bob Johnson", email: "bob@example.com", phone: "345-678-9012", gender: "Male", age: 35, status: "Inactive", dob: "1988-07-10" },
    { id: 4, name: "Alice Brown", email: "alice@example.com", phone: "456-789-0123", gender: "Female", age: 25, status: "Active", dob: "1998-08-05" },
    { id: 5, name: "Charlie Wilson", email: "charlie@example.com", phone: "567-890-1234", gender: "Male", age: 40, status: "Active", dob: "1983-08-12" },
    { id: 6, name: "Diana Miller", email: "diana@example.com", phone: "678-901-2345", gender: "Female", age: 32, status: "Inactive", dob: "1991-08-18" },
    { id: 7, name: "Ethan Davis", email: "ethan@example.com", phone: "789-012-3456", gender: "Male", age: 27, status: "Active", dob: "1996-08-25" },
    { id: 8, name: "Fiona Garcia", email: "fiona@example.com", phone: "890-123-4567", gender: "Female", age: 29, status: "Active", dob: "1994-08-30" }
  ];
  
  render(users);
  renderBirthdayChats(users);
  drawChartFromData(users);
}

function render(data) {
  renderUsers(data);
  renderBirthdayLists(data);
}

function renderUsers(data) {
  container.innerHTML = "";
  const today = new Date();

  data.forEach(user => {
    const card = document.createElement("div");
    card.classList.add("user-card");

    let dobDisplay = "";
    let isBirthdaySoon = false;

    if (user.dob) {
      const dobDate = new Date(user.dob);
      const upcomingBirthday = new Date(today.getFullYear(), dobDate.getMonth(), dobDate.getDate());
      if (upcomingBirthday < today) upcomingBirthday.setFullYear(today.getFullYear() + 1);

      const diffDays = (upcomingBirthday - today) / (1000 * 60 * 60 * 24);
      if (diffDays >= 0 && diffDays <= 7) {
        isBirthdaySoon = true;
        dobDisplay = `<p style="color: var(--highlight);"><strong>üéâ Bday:</strong> ${formatDate(user.dob)} (Soon!)</p>`;
      } else {
        dobDisplay = `<p><strong>Bday:</strong> ${formatDate(user.dob)}</p>`;
      }
    }

    card.innerHTML = `
      <h3 title="${user.name}">${user.name}</h3>
      <p title="${user.email || '-'}"><strong>Email:</strong> ${user.email || "-"}</p>
      <p title="${user.phone || '-'}"><strong>Phone:</strong> ${user.phone || "-"}</p>
      <p title="${user.gender || '-'}"><strong>Gender:</strong> ${user.gender || "-"}</p>
      <p title="${user.age || '-'}"><strong>Age:</strong> ${user.age || "-"}</p>
      <p title="${user.status || '-'}"><strong>Status:</strong> ${user.status || "-"}</p>
      ${dobDisplay}
      <p title="${user.id}"><strong>ID:</strong> ${user.id}</p>
    `;

    if (isBirthdaySoon) {
      card.style.borderColor = "var(--highlight)";
      card.style.boxShadow = "0 0 5px var(--highlight)";
    }

    container.appendChild(card);
  });
}

function formatDate(dateString) {
  if (!dateString) return "";
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
}

function renderBirthdayLists(data) {
  upcomingList.innerHTML = "";
  allBirthdaysList.innerHTML = "";
  const today = new Date();

  // Sort by upcoming birthdays
  const sortedUsers = [...data].sort((a, b) => {
    if (!a.dob || !b.dob) return 0;
    const aDate = new Date(a.dob);
    const bDate = new Date(b.dob);
    const aUpcoming = new Date(today.getFullYear(), aDate.getMonth(), aDate.getDate());
    const bUpcoming = new Date(today.getFullYear(), bDate.getMonth(), bDate.getDate());
    if (aUpcoming < today) aUpcoming.setFullYear(today.getFullYear() + 1);
    if (bUpcoming < today) bUpcoming.setFullYear(today.getFullYear() + 1);
    return aUpcoming - bUpcoming;
  });

  sortedUsers.forEach(user => {
    if (!user.dob) return;

    const dob = new Date(user.dob);
    const birthdayThisYear = new Date(today.getFullYear(), dob.getMonth(), dob.getDate());
    if (birthdayThisYear < today) birthdayThisYear.setFullYear(today.getFullYear() + 1);

    const daysUntil = Math.floor((birthdayThisYear - today) / (1000 * 60 * 60 * 24));
    const li = document.createElement("li");
    li.textContent = `${user.name} ‚Äî ${formatDate(user.dob)}`;
    li.title = `${user.name} ‚Äî ${user.dob}`;

    if (daysUntil >= 0 && daysUntil <= 7) {
      li.classList.add("upcoming");
      upcomingList.appendChild(li);
    }

    allBirthdaysList.appendChild(li.cloneNode(true));
  });
}

function renderBirthdayChats(data) {
  birthdayChats.innerHTML = "";
  const today = new Date();

  data.forEach(user => {
    if (!user.dob || !user.name) return;

    const dob = new Date(user.dob);
    const upcoming = new Date(today.getFullYear(), dob.getMonth(), dob.getDate());
    if (upcoming < today) upcoming.setFullYear(today.getFullYear() + 1);

    const daysUntil = Math.floor((upcoming - today) / (1000 * 60 * 60 * 24));

    if (daysUntil >= 0 && daysUntil <= 7) {
      const li = document.createElement("li");
      if (daysUntil === 0) {
        li.textContent = `üéâ ${user.name}'s Bday!`;
      } else if (daysUntil === 1) {
        li.textContent = `üéÅ Wish ${user.name} tmrw`;
      } else {
        li.textContent = `üéà ${user.name} in ${daysUntil}d`;
      }
      li.title = `${user.name}'s birthday is ${daysUntil === 0 ? 'today' : 'in ' + daysUntil + ' days'}`;
      birthdayChats.appendChild(li);
    }
  });
}

function drawChartFromData(data) {
  const weekdayCounts = [0, 0, 0, 0, 0, 0, 0]; // Sunday to Saturday
  data.forEach(user => {
    if (user.dob) {
      const dob = new Date(user.dob);
      const day = dob.getDay(); // 0 = Sunday, ..., 6 = Saturday
      weekdayCounts[day]++;
    }
  });

  const ctx = document.getElementById('birthdayChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
      datasets: [{
        label: 'Birthdays',
        data: weekdayCounts,
        backgroundColor: 'rgba(46, 204, 113, 0.6)',
        borderColor: 'rgba(46, 204, 113, 1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false }
      },
      scales: {
        y: { 
          beginAtZero: true,
          ticks: {
            precision: 0
          }
        }
      }
    }
  });
}

searchInput.addEventListener("input", (e) => {
  const value = e.target.value.toLowerCase().trim();
  const filtered = users.filter(user => user.name && user.name.toLowerCase().includes(value));
  render(filtered);
  renderBirthdayChats(filtered);
  drawChartFromData(filtered);
});

themeToggle.addEventListener("click", () => {
  const currentTheme = document.documentElement.getAttribute("data-theme");
  document.documentElement.setAttribute("data-theme", currentTheme === "dark" ? "light" : "dark");
});

document.documentElement.setAttribute("data-theme", "light");
loadUsers();
});
</script>
</body>
</html>
